title: <center> <h1> Trabalho Extração de Conhecimento de Dados Biológicos - Grupo 2 </h1> </center>
author: "Joana Gonçalves Pg49835, Bruno Sá Pg49832, Gonçalo Cardoso Pg49834, Luís Ferreira Pg49840"
date: <center>`r format(Sys.time(), '%d/%m/%y')`</center>
output:
  html_document:
    theme: spacelab #united, spacelab, journal
    highlight: kate #zenburn, kate, breezedark
    toc: true
    toc_float:
      collapsed: true
      smooth_scroll: true
    number_sections: true
    code_folding: show
---

\
<center>
![](logo.jpg)
</center>



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```




```{css, echo=FALSE}
.scroll {
  max-height: 300px;
  overflow-y: auto;
}
```

```{=html}
<style>
body {text-align: justify}
div.fontdoc {font-family: georgia;}
    body .main-container {
        max-width: 1750px;
    }
</style>
```

<div class = "fontdoc">

<font size="4">

<a name="topo"></a>

## Explicação dos dados, a sua origem e relevância

O National Cancer Institute (NCI) dos Estados Unidos gere o Genomic Data Commons (GDC), um repositório de dados que fornece acesso a dados genómicos e clínicos de vários projetos de pesquisa sobre vários tipos de cancro , incluindo o TCGA. O GDC fornece uma plataforma para bioinformáticos e clínicos acederem e analisarem os dados do TCGA - GBM juntamente com dados de outros estudos do TCGA e outros projetos.

Depois de analisarmos várias hipoteses de estudo para este trabalho decidimos analisar os dados recolhidos no seguinte [ensaio clínico](https://portal.gdc.cancer.gov/projects/TCGA-GBM). O TCGA - GBM é um estudo genómico que faz parte do projeto TCGA (The Cancer Genome Atlas ) e foca-se num tipo agressivo de cancro cerebral conhecido como glioblastoma multiforme (GBM) .

O objetivo do TCGA - GBM é entender as alterações genéticas e moleculares que ocorrem nesse tipo de cancro para desenvolver novas terapias e tratamentos mais eficazes .

As informações para o TCGA-GBM foram coletadas de amostras de tecido tumoral retiradas de pacientes com GBM , juntamente com detalhes clínicos como idade, sexo e tempo de sobrevivência. O estudo utilizou várias técnicas de análise genómica , como sequenciamento de DNA e RNA , para encontrar alterações genéticas , alterações no número de cópias de genes e expressão diferencial de genes.

Os dados do TCGA-GBM são extremamente importantes para a compreensão do glioblastoma multiforme e possibilitarão bioinformáticos e investigadores encontrar novos alvos terapêuticos para o tratamento desse tipo de cancro. Além disso, esses dados poderão ser usados para desenvolver novas terapias, identificar indicadores e melhorar o diagnóstico e tratamento de GBM .

# Import das Librarys

```{r}

library(TCGAbiolinks)
library(SummarizedExperiment)
library(DESeq2)
library(ggplot2)

```

# Recolha dos dados

### Expressão/Metadados

```{r}

projects = getGDCprojects()
projects$id

proj = "TCGA-GBM"     
query = GDCquery(
  project = proj,
  data.category = "Transcriptome Profiling", 
  data.type = "Gene Expression Quantification",
  workflow.type = "STAR - Counts"
  )

GDCdownload(query)
data_rna_GBM= GDCprepare(query)

```


### Dados clinicos

```{r}

query_clin = GDCquery(project = "TCGA-GBM", 
                  data.category = "Clinical",
                  data.type = "Clinical Supplement", 
                  data.format = "BCR Biotab")

GDCdownload(query_clin)
clinical.GBM = GDCprepare(query_clin)


```




#teste
```{r}

data_rna_GBM_assay = assay(data_rna_GBM, "unstranded" )

data_rna_GBM_assay

plot(data_rna_GBM_assay)
```




# Sumarização

```{r}




```

# Estrutura dos Dados

```{r}

class(data_rna_GBM)
dim(data_rna_GBM)



data_rna_GBM$paper_BCR
str(data_rna_GBM$paper_BCR)


summary(data_rna_GBM$paper_BCR)

data_rna_GBM$paper_Gender
data_rna_GBM$paper_Gender
data_rna_GBM$paper_Gender
data_rna_GBM$paper_Gender

data_rna_GBM$paper_Grade
data_rna_GBM$paper_Grade
data_rna_GBM$paper_Grade
data_rna_GBM$paper_Grade

data_rna_GBM$paper_IDH.status
data_rna_GBM$paper_IDH.status
data_rna_GBM$paper_IDH.status
data_rna_GBM$paper_IDH.status


meta_GBM = colData(data_rna_GBM)
dim(meta_GBM)
meta_GBM$patient
meta_GBM$paper_IDH.status



```

# DE - Diferencal Expression . IDH.staus

```{r}

```{r}


data_rna_GBM$paper_IDH.status

qplot(data_rna_GBM$paper_IDH.status) + ggtitle("Escrever dps") 

```

```{r}


data_de = data_rna_GBM[,!is.na(data_rna_GBM$paper_IDH.status)]

ddsSE = DESeqDataSet(data_de, design = ~ paper_IDH.status)

keep = rowSums(counts(ddsSE)) >= 10
ddsSE = ddsSE[keep,]
ddsSE = DESeq(ddsSE)

resultsNames(ddsSE)

res = results(ddsSE, name = "paper_IDH.status_WT_vs_Mutant")
dea = as.data.frame(res)
summary(res)
DESeq2::plotMA(res, ylim = c(-6,6))

```

# DE - Diferencal Expression - Genero

```{r}
data_rna_GBM$paper_Gender

ggplot2::qplot(data_rna_GBM$paper_Gender)

```

```{r}
data_de = data_rna_GBM[,!is.na(data_rna_GBM$paper_Gender)]

ddsSE = DESeqDataSet(data_de, design = ~ paper_Gender)

keep = rowSums(counts(ddsSE)) >= 10
ddsSE = ddsSE[keep,]
ddsSE = DESeq(ddsSE)

resultsNames(ddsSE)

res = results(ddsSE, name = "paper_Gender_male_vs_female")
dea = as.data.frame(res)
summary(res)
DESeq2::plotMA(res, ylim = c(-7,7))

```

# DE - Estatistica descritiva Subtype

```{r}
data_rna_GBM$paper_Original.Subtype

a = as.factor(data_rna_GBM$paper_Original.Subtype)

qplot(data_rna_GBM$paper_Original.Subtype)



```

```{r}
data_de = data_rna_GBM[,!is.na(data_rna_GBM$paper_Original.Subtype)]

ddsSE = DESeqDataSet(data_de, design = ~ paper_Original.Subtype)

keep = rowSums(counts(ddsSE)) >= 10
ddsSE = ddsSE[keep,]
ddsSE = DESeq(ddsSE)

resultsNames(ddsSE)

res = results(ddsSE, name = "paper_Original.Subtype_G.CIMP_vs_Classical")
dea = as.data.frame(res)
summary(res)
a = DESeq2::plotMA(res, ylim = c(-7,7))

res = results(ddsSE, name = "paper_Original.Subtype_Mesenchymal_vs_Classical")
dea = as.data.frame(res)
summary(res)
b = DESeq2::plotMA(res, ylim = c(-7,7))

res = results(ddsSE, name = "paper_Original.Subtype_Neural_vs_Classical")
dea = as.data.frame(res)
summary(res)
c = DESeq2::plotMA(res, ylim = c(-7,7))

res = results(ddsSE, name = "paper_Original.Subtype_Proneural_vs_Classical")
dea = as.data.frame(res)
summary(res)
d = DESeq2::plotMA(res, ylim = c(-7,7))



```

```{r}
## dados clinicos


names(clinical.GBM)

head (clinical.GBM$clinical_drug_gbm )
df = as.data.frame(clinical.GBM$clinical_drug_gbm)
View(df)

```
